<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bhavesh Chaudhari | Data Analyst Portfolio</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        /* Custom Dark Theme Styles */
        :root {
            --color-primary: #3b82f6; /* Blue 500 */
            --color-secondary: #10b981; /* Emerald 500 */
            --color-background: #111827; /* Gray 900 */
            --color-card: #1f2937; /* Gray 800 */
            --color-text: #f9fafb; /* White */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-background);
            color: var(--color-text);
            min-height: 100vh;
        }
        /* Custom scrollbar for loom videos */
        .project-detail-content {
            max-height: calc(100vh - 10rem); /* Max height for scrolling content */
            overflow-y: auto;
        }
        .project-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .highlight {
            color: var(--color-secondary);
            font-weight: 600;
        }
        .loom-video-container {
            position: relative;
            width: 100%;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
            overflow: hidden;
            border-radius: 0.5rem;
        }
        .loom-video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }
        .code-block {
            background-color: #000000;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: monospace;
            overflow-x: auto;
            border-left: 4px solid var(--color-primary);
            color: #d1d5db; /* Light gray for code text */
            font-size: 0.85rem;
            line-height: 1.4;
            margin-top: 0.75rem;
            margin-bottom: 0.75rem;
        }
    </style>
</head>
<body>
    <!-- PROFILE IMAGE PATH CORRECTION: -->
    <script>
        // CRITICAL FIX: Using the direct file ID found in the uploaded list for the profile picture.
        const PROFILE_PIC_URL = "uploaded:profile.jpg (1).jpg-676b7048-2e7c-4769-b07a-393b5a1575cb"; 
    </script>
    
    <div class="max-w-7xl mx-auto p-4 md:p-8">
        <!-- Navigation -->
        <nav class="flex justify-between items-center py-4 border-b border-gray-700">
            <h1 class="text-3xl font-bold text-gray-100">Bhavesh Chaudhari</h1>
            <a id="back-button" onclick="showHome()" class="hidden text-gray-400 hover:text-blue-400 cursor-pointer transition duration-300">
                &larr; Back to Portfolio
            </a>
            <a href="https://drive.google.com/file/d/1euAL1alPBM8uD0BW5hAtVrlbFkTAGkJP/view?usp=drive_link" target="_blank" class="px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 transition duration-300">
                Download Resume
            </a>
        </nav>

        <!-- Main Portfolio View -->
        <div id="home-view" class="mt-8 grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Column: Profile & Summary -->
            <div class="lg:col-span-1 p-6 rounded-xl shadow-2xl bg-gray-800 h-fit sticky top-8 border border-gray-700">
                <div class="flex flex-col items-center">
                    <!-- The image source now uses the direct upload reference -->
                    <div class="lg:col-span-1 p-6 rounded-xl shadow-2xl bg-gray-800 h-fit sticky top-8 border border-gray-700">
    <div class="flex flex-col items-center">
        <img src="bsc.jpg" alt="Bhavesh Chaudhari Profile Picture" class="w-40 h-40 rounded-full object-cover border-4 border-blue-500 shadow-lg" onerror="this.onerror=null; this.src='https://placehold.co/200x200/4B5563/FFFFFF?text=Photo+Error'">
        <h2 class="mt-4 text-3xl font-extrabold text-white">Bhavesh Chaudhari</h2>
        <p class="text-blue-400 text-lg font-semibold tracking-wider uppercase">Data Analyst | BI Expert</p>
    </div>
    </div>
                    <h2 class="mt-4 text-3xl font-extrabold text-white">Bhavesh Chaudhari</h2>
                    <p class="text-blue-400 text-lg font-semibold tracking-wider uppercase">Data Analyst | BI Expert</p>
                </div>
                
                <div class="mt-6 pt-6 border-t border-gray-700">
                    <h3 class="text-xl font-bold text-gray-200 mb-3">Professional Summary</h3>
                    <p class="text-gray-400 text-sm leading-relaxed">
                        Highly versatile Strategic Business Analyst and C-Level Executive Partner with 4+ years of experience, expertly blending high-stakes executive support with advanced Business Intelligence and Data Analytics. Proven expertise in **Power BI Data Modeling**, rigorous KPI/KRA management, Financial & Operational Analytics, and complex SQL implementation for strategic decision-making.
                    </p>
                </div>

                <div class="mt-6 pt-6 border-t border-gray-700">
                    <h3 class="text-xl font-bold text-gray-200 mb-3">Key Skills</h3>
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 text-sm font-medium bg-blue-900/50 text-blue-300 rounded-full">SQL & Database Governance</span>
                        <span class="px-3 py-1 text-sm font-medium bg-blue-900/50 text-blue-300 rounded-full">Power BI & DAX</span>
                        <span class="px-3 py-1 text-sm font-medium bg-blue-900/50 text-blue-300 rounded-full">Financial Modeling</span>
                        <span class="px-3 py-1 text-sm font-medium bg-blue-900/50 text-blue-300 rounded-full">Python & JavaScript</span>
                        <span class="px-3 py-1 text-sm font-medium bg-blue-900/50 text-blue-300 rounded-full">Operational Analytics</span>
                    </div>
                </div>
            </div>

            <!-- Right Column: Projects Grid -->
            <div class="lg:col-span-2">
                <h2 class="text-3xl font-bold mb-6 text-gray-200 border-b pb-2 border-gray-700">Analytical Projects</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Project A Card -->
                    <div class="project-card p-6 bg-gray-800 rounded-xl shadow-lg cursor-pointer transition duration-300 border border-gray-700 hover:border-blue-500" onclick="showProject('A')">
                        <div class="text-2xl font-bold text-blue-400 mb-2 flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                            Project A: Solar Fleet Performance & Financial Summary
                        </div>
                        <p class="text-gray-400">A mission-critical Power BI dashboard monitoring operational KPIs (PR, CUF) and financial impact of a solar fleet.</p>
                        <p class="mt-3 text-sm text-blue-500 font-semibold">View Case Study & Video &rarr;</p>
                    </div>

                    <!-- Project B Card -->
                    <div class="project-card p-6 bg-gray-800 rounded-xl shadow-lg cursor-pointer transition duration-300 border border-gray-700 hover:border-emerald-500" onclick="showProject('B')">
                        <div class="text-2xl font-bold text-emerald-400 mb-2 flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                            Project B: Unified Data Web Platform
                        </div>
                        <p class="text-gray-400">Building a web application to efficiently unify and preprocess disparate data sources for visualization.</p>
                        <p class="mt-3 text-sm text-emerald-500 font-semibold">Visit Live Site & Video &rarr;</p>
                    </div>

                    <!-- Project C Card (UPDATED) -->
                    <div class="project-card p-6 bg-gray-800 rounded-xl shadow-lg cursor-pointer transition duration-300 border border-gray-700 hover:border-pink-500" onclick="showProject('C')">
                        <div class="text-2xl font-bold text-pink-400 mb-2 flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                            Project C: Strategic SQL Data Engineering & Analytics
                        </div>
                        <p class="text-gray-400">Expertly engineered data pipelines using complex SQL (Window Functions, CTEs) for deep HR and Financial insights.</p>
                        <p class="mt-3 text-sm text-pink-500 font-semibold">View Case Study & Code &rarr;</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Project Detail View (Hidden by Default) -->
        <div id="project-view" class="mt-8 hidden">
            <h2 id="project-title" class="text-4xl font-extrabold text-blue-400 mb-6 border-b pb-2 border-gray-700"></h2>
            
            <div class="project-detail-content lg:grid lg:grid-cols-3 gap-8">
                <!-- Video Column -->
                <div class="lg:col-span-2">
                    <h3 class="text-2xl font-semibold mb-3 text-gray-200">Video Walkthrough</h3>
                    <div id="project-video" class="loom-video-container mb-6">
                        <!-- Loom iframe will be inserted here -->
                    </div>
                    
                    <h3 class="text-2xl font-semibold mb-3 text-gray-200 mt-6">Project Overview</h3>
                    <div id="project-details" class="bg-gray-800 p-6 rounded-xl border border-gray-700 text-gray-300">
                        <!-- Details will be inserted here -->
                    </div>
                </div>

                <!-- Technical Stack Column -->
                <div class="lg:col-span-1">
                    <h3 class="text-2xl font-semibold mb-3 text-gray-200">Technical Stack</h3>
                    <div id="project-stack" class="flex flex-col gap-4">
                        <!-- Stack badges will be inserted here -->
                    </div>
                    
                    <div id="project-link-section" class="mt-8 pt-4 border-t border-gray-700 hidden">
                        <h3 class="text-xl font-semibold mb-3 text-gray-200">Live Application</h3>
                        <a id="project-live-link" href="#" target="_blank" class="block w-full text-center px-4 py-3 bg-emerald-600 text-white font-semibold rounded-lg shadow-md hover:bg-emerald-700 transition duration-300">
                            Visit Live Site
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const projectData = {
            'A': {
                title: "Power BI: Strategic Solar Fleet Performance & Financial Summary",
                video: "https://www.loom.com/embed/460bf78928e34a4980f2560bbe2ad49e",
                stack: [
                    { name: "Power BI", color: "bg-yellow-500" },
                    { name: "DAX (Advanced)", color: "bg-indigo-500" },
                    { name: "Financial Modeling", color: "bg-green-500" },
                    { name: "Star Schema Modeling", color: "bg-blue-500" },
                ],
                details: `
                    <p class="mb-4">This project delivers a mission-critical Business Intelligence dashboard for a large-scale Solar Fleet, focusing on real-time operational efficiency (CUF, PR) and the financial impact of plant performance. It provides C-level executives with a single view of technical and fiscal health.</p>
                    <h4 class="text-xl font-bold mt-4 mb-2 text-blue-400">Key DAX Functions & Logic:</h4>
                    <ul class="list-disc pl-5 space-y-2 text-sm">
                        <li>**Dynamic Financial Calculations:** Implemented the advanced DAX function <span class="highlight">LOOKUPVALUE</span> to pull the dynamic **Tariff Rate (INR/kWh)** from a separate financial table, enabling the calculation of <span class="highlight">Daily Revenue</span> and <span class="highlight">Operating Margin (Opex)</span> at the plant level.</li>
                        <li>**Performance Metrics:** Designed complex measures to track the <span class="highlight">Performance Ratio (PR)</span> and <span class="highlight">Capacity Utilization Factor (CUF)</span> against future targets sourced from the data model.</li>
                        <li>**Downtime Impact Analysis:** Created measures to quantify the **Lost Generation (kWh)** and **Lost Revenue (INR)** due to inverter downtime by cross-referencing the Downtime Log with generation data.</li>
                        <li>**Time Intelligence & Forecasting:** Utilized functions like <span class="highlight">TOTALYTD</span> and sophisticated rolling averages to compare current generation against historical benchmarks and future targets, driving predictive maintenance strategy.</li>
                    </ul>
                `
            },
            'B': {
                title: "Full-Stack Data Unification Web Application",
                video: "https://www.loom.com/embed/e7262eab893442f3a3509f90affd5619",
                live_link: "https://bhavesh1972.github.io/Portfolio/",
                stack: [
                    { name: "JavaScript (Frontend)", color: "bg-yellow-500" },
                    { name: "Python (Backend/Data Prep)", color: "bg-blue-500" },
                    { name: "Pandas", color: "bg-indigo-500" },
                    { name: "D3.js / Chart.js", color: "bg-pink-500" },
                ],
                details: `
                    <p class="mb-4">This project involves building a web application to ingest and normalize data from multiple disparate sources (e.g., CSV, APIs, relational databases) into a single, cohesive dataset. This **unified data asset** is the foundation for reliable, enterprise-level reporting.</p>
                    <h4 class="text-xl font-bold mt-4 mb-2 text-emerald-400">Technical Components:</h4>
                    <ul class="list-disc pl-5 space-y-2 text-sm">
                        <li>**Frontend (JavaScript):** Managed user interaction and displayed visualizations using libraries like <span class="highlight">D3.js</span> and <span class="highlight">Chart.js</span>.</li>
                        <li>**Backend (Python):** Utilized Python with the <span class="highlight">Pandas library</span> for robust data manipulation, cleaning, transformation, and merging operations.</li>
                        <li>**Value of Unified Data:** Having a single, source-of-truth file ensures that all dashboards and visualizations (whether in Power BI, Tableau, or web-based tools) draw from the exact same standardized definitions and calculations, eliminating data silos and conflicts across the organization.</li>
                    </ul>
                `
            },
            'C': {
                title: "Strategic SQL Data Engineering & Analytics",
                video: "https://www.loom.com/embed/2ea76970745d4a748f5ffc776ada65f5",
                stack: [
                    { name: "MySQL / SQL Server", color: "bg-gray-400" },
                    { name: "Window Functions", color: "bg-purple-500" },
                    { name: "CTEs", color: "bg-red-500" },
                    { name: "ETL Processes", color: "bg-green-500" },
                ],
                details: `
                    <p class="mb-4">This project demonstrates expertise in building robust Data Mart schemas and writing **high-impact, complex SQL queries** (DML) to extract deep, strategic insights for leadership decision-making across HR and finance. These queries are the backbone of automated BI reports.</p>
                    <h4 class="text-xl font-bold mt-4 mb-2 text-pink-400">1. Attrition Risk: Identifying Underpaid High-Performers</h4>
                    <p class="text-sm mb-2">Used the **Window Function** <span class="highlight">NTILE(4)</span> to segment employee salaries relative to their peers within the same department. This allows for fair compensation analysis and flags high-performers who are most likely to leave due to salary disparity (Low Pay Quartile + High Performance Score).</p>
                    <div class="code-block">
        WITH DepartmentSalaryQuartiles AS (<br>
            &nbsp;&nbsp;&nbsp;&nbsp;SELECT<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;employee_id,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NTILE(4) OVER (<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARTITION BY department<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER BY salary ASC<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) AS salary_quartile_rank<br>
            &nbsp;&nbsp;&nbsp;&nbsp;FROM employees<br>
            ),<br>
            EmployeeAvgRating AS (<br>
            &nbsp;&nbsp;&nbsp;&nbsp;SELECT<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;employee_id,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVG(rating_score) AS avg_rating<br>
            &nbsp;&nbsp;&nbsp;&nbsp;FROM performance_reviews<br>
            &nbsp;&nbsp;&nbsp;&nbsp;GROUP BY employee_id<br>
            )<br>
            SELECT<br>
            &nbsp;&nbsp;&nbsp;&nbsp;e.employee_id,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;e.employee_name,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;e.department,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;e.salary,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;ear.avg_rating<br>
            FROM employees e<br>
            JOIN DepartmentSalaryQuartiles dsq<br>
            &nbsp;&nbsp;&nbsp;&nbsp;ON e.employee_id = dsq.employee_id<br>
            JOIN EmployeeAvgRating ear<br>
            &nbsp;&nbsp;&nbsp;&nbsp;ON e.employee_id = ear.employee_id<br>
            WHERE<br>
            &nbsp;&nbsp;&nbsp;&nbsp;dsq.salary_quartile_rank = 1<br>
            &nbsp;&nbsp;&nbsp;&nbsp;AND ear.avg_rating >= 4.0<br>
            ORDER BY ear.avg_rating DESC, e.salary ASC;
                    </div>

                    <h4 class="text-xl font-bold mt-4 mb-2 text-pink-400">2. Highest-Paid Employees in Marketing, and When Were They Hired?</h4>
                    <p class="text-sm mb-2">A foundational HR query demonstrating the use of filtering (<span class="highlight">WHERE</span>), sorting (<span class="highlight">ORDER BY</span>), and date formatting (<span class="highlight">DATE_FORMAT</span>) to quickly highlight key employee information for executive review.</p>
                    <div class="code-block">
            USE hr_dashboard_data ;<br>
            SELECT<br>
            &nbsp;&nbsp;&nbsp;&nbsp;employee_name,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;department,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;salary,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;DATE_FORMAT(hire_date, '%M %D, %Y') AS formatted_hire_date<br>
            FROM<br>
            &nbsp;&nbsp;&nbsp;&nbsp;employees<br>
            WHERE<br>
            &nbsp;&nbsp;&nbsp;&nbsp;department = 'Marketing'<br>
            ORDER BY<br>
            &nbsp;&nbsp;&nbsp;&nbsp;salary DESC<br>
            LIMIT 5;
    </div>
                    
                    <h4 class="text-xl font-bold mt-4 mb-2 text-pink-400">3. Analyzing Project Involvement for High Performers</h4>
                    <p class="text-sm mb-2">A complex analytical query using **multiple JOINs** and **aggregation** (<span class="highlight">SUM</span>) to link high performance ratings with detailed project involvement, identifying which projects are consuming the most time from top talent.</p>
                    <div class="code-block">
            SELECT<br>
            &nbsp;&nbsp;&nbsp;&nbsp;E.employee_name,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;T1.review_date,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;T1.rating_score,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;P.project_name,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;P.project_budget,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;SUM(TL.hours_worked) AS total_hours_on_project<br>
            FROM<br>
            &nbsp;&nbsp;&nbsp;&nbsp;performance_reviews AS T1<br>
            JOIN<br>
            &nbsp;&nbsp;&nbsp;&nbsp;employees AS E ON T1.employee_id = E.employee_id<br>
            JOIN<br>
            &nbsp;&nbsp;&nbsp;&nbsp;time_logs AS TL ON E.employee_id = TL.employee_id<br>
            JOIN<br>
            &nbsp;&nbsp;&nbsp;&nbsp;projects AS P ON TL.project_id = P.project_id<br>
            WHERE<br>
            &nbsp;&nbsp;&nbsp;&nbsp;T1.rating_score >= 3.5<br>
            GROUP BY<br>
            &nbsp;&nbsp;&nbsp;&nbsp;E.employee_name, T1.review_date, T1.rating_score, P.project_name, P.project_budget<br>
            ORDER BY<br>
            &nbsp;&nbsp;&nbsp;&nbsp;E.employee_name, total_hours_on_project DESC;
        </div>
                    <h4 class="text-xl font-bold mt-4 mb-2 text-pink-400">4. Finding Recent Salary Changes (Promotions/Reviews)</h4>
                    <p class="text-sm mb-2">A crucial HR query that joins compensation history with employee data to track recent salary changes, calculate the percentage increase, and filter for key events like promotions or annual reviews (<span class="highlight">ROUND</span>, <span class="highlight">JOIN</span>, <span class="highlight">WHERE IN</span>).</p>
                    <div class="code-block">
            SELECT<br>
            &nbsp;&nbsp;&nbsp;&nbsp;E.employee_name,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;CH.change_date,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;CH.change_reason,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;CH.old_salary,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;CH.new_salary,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;ROUND(((CH.new_salary - CH.old_salary) / CH.old_salary) * 100, 2) AS percentage_increase<br>
            FROM<br>
            &nbsp;&nbsp;&nbsp;&nbsp;compensation_history AS CH<br>
            JOIN<br>
            &nbsp;&nbsp;&nbsp;&nbsp;employees AS E ON CH.employee_id = E.employee_id<br>
            WHERE<br>
            &nbsp;&nbsp;&nbsp;&nbsp;CH.change_reason IN ('Promotion', 'Annual Review')<br>
            ORDER BY<br>
            &nbsp;&nbsp;&nbsp;&nbsp;CH.change_date DESC<br>
            LIMIT 10;
        </div>
                    <h4 class="text-xl font-bold mt-4 mb-2 text-pink-400">5. Identifying High-Performing Employees with Stagnant Compensation</h4>
                    <p class="text-sm mb-2">A high-impact query demonstrating **attrition risk analysis** by joining performance reviews and compensation history to find top talent (<span class="highlight">HAVING AVG(rating) >= 4.0</span>) who have not received a raise in over a year (<span class="highlight">DATEDIFF > 365</span>).</p>
                    <div class="code-block">
            SELECT<br>
            &nbsp;&nbsp;&nbsp;&nbsp;E.employee_name,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;E.department,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;ROUND(AVG(PR.rating_score), 2) AS avg_rating,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;MAX(CH.change_date) AS last_raise_date,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;DATEDIFF(CURRENT_DATE(), MAX(CH.change_date)) AS days_since_last_raise<br>
            FROM<br>
            &nbsp;&nbsp;&nbsp;&nbsp;employees AS E<br>
            JOIN<br>
            &nbsp;&nbsp;&nbsp;&nbsp;performance_reviews AS PR ON E.employee_id = PR.employee_id<br>
            LEFT JOIN<br>
            &nbsp;&nbsp;&nbsp;&nbsp;compensation_history AS CH ON E.employee_id = CH.employee_id<br>
            GROUP BY<br>
            &nbsp;&nbsp;&nbsp;&nbsp;E.employee_id, E.employee_name, E.department<br>
            HAVING<br>
            &nbsp;&nbsp;&nbsp;&nbsp;avg_rating >= 4.0<br>
            &nbsp;&nbsp;&nbsp;&nbsp;AND days_since_last_raise > 365<br>
            ORDER BY<br>
            &nbsp;&nbsp;&nbsp;&nbsp;days_since_last_raise DESC;
        </div>
                    <h4 class="text-xl font-bold mt-4 mb-2 text-pink-400">6. Project Profitability (Estimated Labor Cost vs. Budget)</h4>
                    <p class="text-sm mb-2">A critical financial query that links project data, employee time logs, and employee salaries to calculate the **estimated labor cost** for each project and determine the budget surplus or deficit (<span class="highlight">ROUND</span>, <span class="highlight">SUM</span>, **multiple JOINs**).</p>
                    <div class="code-block">
            SELECT<br>
            &nbsp;&nbsp;&nbsp;&nbsp;P.project_name,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;P.project_budget,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;ROUND(SUM(TL.hours_worked * (E.salary / 2080)), 2) AS estimated_labor_cost,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;ROUND(P.project_budget - SUM(TL.hours_worked * (E.salary / 2080)), 2) AS budget_remaining<br>
            FROM<br>
            &nbsp;&nbsp;&nbsp;&nbsp;projects AS P<br>
            JOIN<br>
            &nbsp;&nbsp;&nbsp;&nbsp;time_logs AS TL ON P.project_id = TL.project_id<br>
            JOIN<br>
            &nbsp;&nbsp;&nbsp;&nbsp;employees AS E ON TL.employee_id = E.employee_id<br>
            GROUP BY<br>
            &nbsp;&nbsp;&nbsp;&nbsp;P.project_id, P.project_name, P.project_budget<br>
            ORDER BY<br>
            &nbsp;&nbsp;&nbsp;&nbsp;budget_remaining;
        </div>
                    <h4 class="text-xl font-bold mt-4 mb-2 text-pink-400">7. Performance Score Distribution by Department</h4>
                    <p class="text-sm mb-2">A powerful analytical technique using **Conditional Aggregation** (<span class="highlight">SUM(CASE...)</span>) to quickly calculate the departmental percentage of high and low performance scores in a single, efficient query for benchmarking across the organization.</p>
                    <div class="code-block">
            SELECT<br>
            &nbsp;&nbsp;&nbsp;&nbsp;E.department,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;COUNT(PR.review_id) AS total_reviews,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;SUM(CASE WHEN PR.rating_score >= 4.5 THEN 1 ELSE 0 END) AS high_score_count,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;SUM(CASE WHEN PR.rating_score <= 2.5 THEN 1 ELSE 0 END) AS low_score_count,<br>
            &nbsp;&nbsp;&nbsp;&nbsp;ROUND((SUM(CASE WHEN PR.rating_score >= 4.5 THEN 1 ELSE 0 END) * 100.0) / COUNT(PR.review_id), 2) AS percent_high_scores<br>
            FROM<br>
            &nbsp;&nbsp;&nbsp;&nbsp;employees AS E<br>
            JOIN<br>
            &nbsp;&nbsp;&nbsp;&nbsp;performance_reviews AS PR ON E.employee_id = PR.employee_id<br>
            GROUP BY<br>
            &nbsp;&nbsp;&nbsp;&nbsp;E.department<br>
            ORDER BY<br>
            &nbsp;&nbsp;&nbsp;&nbsp;percent_high_scores DESC;
        </div>
                `
            }
        };

        const homeView = document.getElementById('home-view');
        const projectView = document.getElementById('project-view');
        const backButton = document.getElementById('back-button');
        const projectTitle = document.getElementById('project-title');
        const projectVideo = document.getElementById('project-video');
        const projectDetails = document.getElementById('project-details');
        const projectStack = document.getElementById('project-stack');
        const projectLinkSection = document.getElementById('project-link-section');
        const projectLiveLink = document.getElementById('project-live-link');

        function showHome() {
            homeView.classList.remove('hidden');
            projectView.classList.add('hidden');
            backButton.classList.add('hidden');
            projectVideo.innerHTML = ''; // Clear video
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showProject(id) {
            const data = projectData[id];
            
            // 1. Update Title and Views
            projectTitle.textContent = data.title;
            homeView.classList.add('hidden');
            projectView.classList.remove('hidden');
            backButton.classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // 2. Video
            projectVideo.innerHTML = `<iframe src="${data.video}?autoplay=false&loop=false&hide_share=true&hide_title=true&hideEmbedTopBar=true" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen allow="camera; microphone; fullscreen; xr-spatial-tracking; payment" referrerpolicy="strict-origin-when-cross-origin"></iframe>`;

            // 3. Details
            projectDetails.innerHTML = data.details;

            // 4. Stack
            projectStack.innerHTML = data.stack.map(item => `
                <span class="${item.color} text-white font-semibold px-4 py-2 rounded-lg shadow-md">
                    ${item.name}
                </span>
            `).join('');

            // 5. Live Link (Project B only)
            if (data.live_link) {
                projectLiveLink.href = data.live_link;
                projectLinkSection.classList.remove('hidden');
            } else {
                projectLinkSection.classList.add('hidden');
            }
        }

        // Initialize view on load (ensure everything is hidden/shown correctly)
        window.onload = showHome;
    </script>
</body>
</html>